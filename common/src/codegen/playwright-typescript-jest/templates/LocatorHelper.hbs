import { Locator, Page } from "playwright";

export class LocatorHelper {
    public static async GetLocatorTagTypeAsync(locator: Locator) {
        return await locator.evaluate<string>("e => e.tagName");
    }

    /// <summary>
    /// Dyanmic input based on locator tag
    /// </summary>
    /// <param name="locator">Locator name</param>
    /// <param name="data">Data to be input</param>
    public static async InputAsync(locator: Locator, data: string) {
        let tagName = await LocatorHelper.GetLocatorTagTypeAsync(locator);
        switch (tagName.toLowerCase()) {
            case "input":
                await locator.fill("");
                await locator.type(data);
                break;
            case "select":
                await locator.selectOption(data);
                break;
            default:
                await locator.fill("");
                await locator.type(data);
                break;
        }
    }

    /// <summary>
    /// Click outside of element. This will helps Single Page Application sets it states to new value
    /// </summary>
    /// <param name="page">Playwright page</param>
    public static async ClickOutsideAsync(page: Page) {
        await page.locator("xpath=//body >> nth=0").click();
    }
}
